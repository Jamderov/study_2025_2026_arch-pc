---
## Author
author:
  name: Дмитраков Михаил Алексеевич
  email: 1132250457@rudn.ru
  affiliation:
    - name: Российский университет дружбы народов
      country: Российская Федерация
      postal-code: 117198
      city: Москва
      address: ул. Миклухо-Маклая, д. 6

## Title
subtitle: "Архитектура компьютеров"
title: "Отчёт по лабораторной работе 6"
license: "CC BY"
---


# Цель работы

Целью работы является освоение арифметических инструкций языка ассемблера NASM.

# Выполнение лабораторной работы

## Символьные и численные данные в NASM

В начале лабораторной работы я создаю отдельный каталог для программ лабораторной № 6, перехожу в него и формирую файл `lab6-1.asm`.

Далее рассматриваю примеры программ, предназначенных для вывода символов и чисел. Во всех случаях вывод осуществляется на основе значения, находящегося в регистре `eax`.

В первой программе в регистр `eax` помещается символ `'6'` с помощью инструкции `mov eax, '6'`, а в регистр `ebx` — символ `'4'` (`mov ebx, '4'`). Затем выполняется сложение содержимого регистров (`add eax, ebx`), и результат сохраняется в `eax`, после чего выводится на экран.

![Код программы lab6-1.asm](image/01.png){ #fig:001 width=70%, height=70% } 

![Запуск программы lab6-1.asm](image/02.png){ #fig:002 width=70%, height=70% }

Ожидаемым результатом является число 10, однако на экране появляется символ `j`. Это объясняется тем, что складываются не числа, а их ASCII-коды: код символа `'6'` равен 54, а символа `'4'` — 52. В результате сложения получается 106, что соответствует символу `j` в таблице ASCII.

Затем программа была изменена: вместо символов в регистры записываются числовые значения.

![Код программы lab6-1.asm с числами](image/03.png){ #fig:003 width=70%, height=70% } 

![Запуск программы lab6-1.asm с числами](image/04.png){ #fig:004 width=70%, height=70% }

Однако и в этом случае результатом не является число 10. Выводится символ с кодом 10, который соответствует переводу строки. В терминале он визуально не отображается, но приводит к появлению пустой строки.

Для корректной работы с числовыми значениями используются подпрограммы из файла `in_out.asm`, предназначенные для преобразования ASCII-символов в числа и обратно. Программа была доработана с использованием этих функций.

![Код программы lab6-2.asm](image/05.png){ #fig:005 width=70%, height=70% } 

![Запуск программы lab6-2.asm](image/06.png){ #fig:006 width=70%, height=70% }

В результате выполнения данной версии программы выводится число 106. Команда `add` по-прежнему складывает коды символов `'6'` и `'4'`, однако функция `iprintLF` выводит числовое значение, а не соответствующий символ.

После этого символы снова были заменены на числа.

![Код программы lab6-2.asm с числами](image/07.png){ #fig:007 width=70%, height=70% } 

В данном случае функция `iprintLF` корректно выводит результат вычислений, так как операндами являются числовые значения. Итоговый результат — число 10.

![Запуск программы lab6-2.asm с числами](image/08.png){ #fig:008 width=70%, height=70% }

Затем функция `iprintLF` была заменена на `iprint`. После пересборки и запуска программы вывод отличается отсутствием переноса строки.

![Запуск программы lab6-2.asm без переноса строки](image/09.png){ #fig:009 width=70%, height=70% }

## Выполнение арифметических операций в NASM

Для демонстрации арифметических операций в NASM рассматривается программа, вычисляющая выражение  
$f(x) = (5 * 2 + 3) / 3$.

![Код программы lab6-3.asm](image/10.png){ #fig:010 width=70%, height=70% } 

![Запуск программы lab6-3.asm](image/11.png){ #fig:011 width=70%, height=70% }

Далее программа была изменена для вычисления выражения  
$f(x) = (4 * 6 + 2) / 5$. После создания исполняемого файла была проверена корректность его работы.

![Код программы lab6-3.asm с новым выражением](image/12.png){ #fig:012 width=70%, height=70% } 

![Запуск программы lab6-3.asm с новым выражением](image/13.png){ #fig:013 width=70%, height=70% }

После этого была рассмотрена программа, предназначенная для вычисления варианта задания по номеру студенческого билета.

![Код программы variant.asm](image/14.png){ #fig:014 width=70%, height=70% } 

![Запуск программы variant.asm](image/15.png){ #fig:015 width=70%, height=70% }

В данной программе исходное число вводится с клавиатуры в символьном виде. Для дальнейших вычислений введённые данные преобразуются в числовой формат с использованием подпрограммы `atoi` из файла `in_out.asm`.

### Ответы на вопросы

1. **Какие строки отвечают за вывод сообщения «Ваш вариант:»?**
   * Инструкция `mov eax, rem` загружает адрес строки с текстом «Ваш вариант:» в регистр `eax`.
   * Инструкция `call sprint` вызывает подпрограмму вывода строки.

2. **Назначение инструкций:**
   * `mov ecx, x` — помещает адрес или значение переменной `x` в регистр `ecx`.
   * `mov edx, 80` — задаёт максимальный размер вводимых данных.
   * `call sread` — вызывает подпрограмму считывания данных с клавиатуры.

3. **Для чего используется `call atoi`?**
   * Данная инструкция преобразует введённую строку символов в числовое значение.

4. **Какие инструкции отвечают за вычисление варианта?**
   * `xor edx, edx` — обнуляет регистр `edx`.
   * `mov ebx, 20` — загружает делитель.
   * `div ebx` — выполняет деление.
   * `inc edx` — увеличивает остаток от деления на единицу.

5. **В какой регистр помещается остаток от деления?**
   * Остаток сохраняется в регистре `edx`.

6. **Назначение инструкции `inc edx`:**
   * Увеличивает значение остатка на 1 в соответствии с формулой определения варианта.

7. **Какие инструкции отвечают за вывод результата?**
   * `mov eax, edx` — передаёт результат в регистр `eax`.
   * `call iprintLF` — выводит числовое значение на экран с переводом строки.

## Задание для самостоятельной работы

В рамках самостоятельного задания была разработана программа для вычисления выражения  
$y = f(x)$. Программа выводит формулу, запрашивает ввод значения `x`, вычисляет результат и отображает его на экране.  

Согласно полученному варианту № 18 используется формула  
$3(x + 10) - 20$ при значениях $x = 1$ и $x = 5$.

![Код программы task.asm](image/16.png){ #fig:016 width=70%, height=70% }

При значении $x = 1$ результат равен 13.  
При значении $x = 5$ результат равен 25.

![Запуск программы task.asm](image/17.png){ #fig:017 width=70%, height=70% }

Результаты вычислений соответствуют ожидаемым, что подтверждает корректность работы программы.


# Выводы

Изучили работу с арифметическими операциями.
